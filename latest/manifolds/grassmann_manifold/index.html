<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Grassmann · GeometricMachineLearning.jl</title><meta name="title" content="Grassmann · GeometricMachineLearning.jl"/><meta property="og:title" content="Grassmann · GeometricMachineLearning.jl"/><meta property="twitter:title" content="Grassmann · GeometricMachineLearning.jl"/><meta name="description" content="Documentation for GeometricMachineLearning.jl."/><meta property="og:description" content="Documentation for GeometricMachineLearning.jl."/><meta property="twitter:description" content="Documentation for GeometricMachineLearning.jl."/><meta property="og:url" content="https://juliagni.github.io/GeometricMachineLearning.jl/manifolds/grassmann_manifold/"/><meta property="twitter:url" content="https://juliagni.github.io/GeometricMachineLearning.jl/manifolds/grassmann_manifold/"/><link rel="canonical" href="https://juliagni.github.io/GeometricMachineLearning.jl/manifolds/grassmann_manifold/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/extra_styles.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="GeometricMachineLearning.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="GeometricMachineLearning.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Architectures</span><ul><li><a class="tocitem" href="../../architectures/sympnet/">SympNet</a></li></ul></li><li><span class="tocitem">Manifolds</span><ul><li><a class="tocitem" href="../basic_topology/">Concepts from General Topology</a></li><li><a class="tocitem" href="../manifolds/">General Theory on Manifolds</a></li><li><a class="tocitem" href="../inverse_function_theorem/">The Inverse Function Theorem</a></li><li><a class="tocitem" href="../submersion_theorem/">The Submersion Theorem</a></li><li><a class="tocitem" href="../homogeneous_spaces/">Homogeneous Spaces</a></li><li><a class="tocitem" href="../stiefel_manifold/">Stiefel</a></li><li class="is-active"><a class="tocitem" href>Grassmann</a><ul class="internal"><li><a class="tocitem" href="#The-Riemannian-Gradient"><span>The Riemannian Gradient</span></a></li></ul></li><li><a class="tocitem" href="../existence_and_uniqueness_theorem/">Differential Equations and the EAU theorem</a></li></ul></li><li><span class="tocitem">Arrays</span><ul><li><a class="tocitem" href="../../arrays/stiefel_lie_alg_horizontal/">Stiefel Global Tangent Space</a></li><li><a class="tocitem" href="../../arrays/grassmann_lie_alg_hor_matrix/">Grassmann Global Tangent Space</a></li></ul></li><li><span class="tocitem">Optimizer Framework</span><ul><li><a class="tocitem" href="../../Optimizer/">Optimizers</a></li><li><a class="tocitem" href="../../optimizers/general_optimization/">General Optimization</a></li></ul></li><li><span class="tocitem">Optimizer Functions</span><ul><li><a class="tocitem" href="../../optimizers/manifold_related/horizontal_lift/">Horizontal Lift</a></li><li><a class="tocitem" href="../../optimizers/manifold_related/global_sections/">Global Sections</a></li><li><a class="tocitem" href="../../optimizers/manifold_related/retractions/">Retractions</a></li><li><a class="tocitem" href="../../optimizers/manifold_related/geodesic/">Geodesic Retraction</a></li><li><a class="tocitem" href="../../optimizers/manifold_related/cayley/">Cayley Retraction</a></li><li><a class="tocitem" href="../../optimizers/adam_optimizer/">Adam Optimizer</a></li><li><a class="tocitem" href="../../optimizers/bfgs_optimizer/">BFGS Optimizer</a></li></ul></li><li><span class="tocitem">Special Neural Network Layers</span><ul><li><a class="tocitem" href="../../layers/attention_layer/">Attention</a></li><li><a class="tocitem" href="../../layers/multihead_attention_layer/">Multihead Attention</a></li></ul></li><li><span class="tocitem">Data Loader</span><ul><li><a class="tocitem" href="../../data_loader/data_loader/">Routines</a></li><li><a class="tocitem" href="../../data_loader/snapshot_matrix/">Snapshot matrix &amp; tensor</a></li></ul></li><li><span class="tocitem">Reduced Order Modelling</span><ul><li><a class="tocitem" href="../../reduced_order_modeling/autoencoder/">POD and Autoencoders</a></li><li><a class="tocitem" href="../../reduced_order_modeling/symplectic_autoencoder/">PSD and Symplectic Autoencoders</a></li><li><a class="tocitem" href="../../reduced_order_modeling/kolmogorov_n_width/">Kolmogorov n-width</a></li><li><a class="tocitem" href="../../reduced_order_modeling/projection_reduction_errors/">Projection and Reduction Error</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/sympnet_tutorial/">Sympnets</a></li><li><a class="tocitem" href="../../tutorials/linear_wave_equation/">Linear Wave Equation</a></li><li><a class="tocitem" href="../../tutorials/mnist_tutorial/">MNIST</a></li><li><a class="tocitem" href="../../tutorials/grassmann_layer/">Grassmann manifold</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li><li><a class="tocitem" href="../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manifolds</a></li><li class="is-active"><a href>Grassmann</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Grassmann</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGNI/GeometricMachineLearning.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGNI/GeometricMachineLearning.jl/blob/main/docs/src/manifolds/grassmann_manifold.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Grassmann-Manifold"><a class="docs-heading-anchor" href="#Grassmann-Manifold">Grassmann Manifold</a><a id="Grassmann-Manifold-1"></a><a class="docs-heading-anchor-permalink" href="#Grassmann-Manifold" title="Permalink"></a></h1><p>(The description of the Grassmann manifold is based on that of the <a href="../stiefel_manifold/">Stiefel manifold</a>, so this should be read first.)</p><p>An element of the Grassmann manifold <span>$G(n,N)$</span> is a vector subspace <span>$\subset\mathbb{R}^N$</span> of dimension <span>$n$</span>. Each such subspace (i.e. element of the Grassmann manifold) can be represented by a full-rank matrix <span>$A\in\mathbb{R}^{N\times{}n}$</span> and we identify two elements with the following equivalence relation: </p><p class="math-container">\[A_1 \sim A_2 \iff \exists{}C\in\mathbb{R}^{n\times{}n}\text{ s.t. }A_1C = A_2.\]</p><p>The resulting manifold is of dimension <span>$n(N-n)$</span>. One can find a parametrization of the manifold the following way: Because the matrix <span>$Y$</span> has full rank, there have to be <span>$n$</span> independent columns in it: <span>$i_1, \ldots, i_n$</span>. For simplicity assume that <span>$i_1 = 1, i_2=2, \ldots, i_n=n$</span> and call the matrix made up by these columns <span>$C$</span>. Then the mapping to the coordinate chart is: <span>$YC^{-1}$</span> and the last <span>$N-n$</span> columns are the coordinates.</p><p>We can also define the Grassmann manifold based on the Stiefel manifold since elements of the Stiefel manifold are already full-rank matrices. In this case we have the following equivalence relation (for <span>$Y_1, Y_2\in{}St(n,N)$</span>): </p><p class="math-container">\[Y_1 \sim Y_2 \iff \exists{}C\in{}O(n)\text{ s.t. }Y_1C = Y_2.\]</p><h2 id="The-Riemannian-Gradient"><a class="docs-heading-anchor" href="#The-Riemannian-Gradient">The Riemannian Gradient</a><a id="The-Riemannian-Gradient-1"></a><a class="docs-heading-anchor-permalink" href="#The-Riemannian-Gradient" title="Permalink"></a></h2><p>Obtaining the Riemannian Gradient for the Grassmann manifold is slightly more difficult than it is in the case of the Stiefel manifold. Since the Grassmann manifold can be obtained from the Stiefel manifold through an equivalence relation however, we can use this as a starting point. In a first step we identify charts on the Grassmann manifold to make dealing with it easier. For this consider the following open cover of the Grassmann manifold (also see [<a href="../../references/#absil2004riemannian">8</a>]): </p><p class="math-container">\[\{\mathcal{U}_W\}_{W\in{}St(n, N)} \quad\text{where}\quad \mathcal{U}_W = \{\mathrm{span}(Y):\mathrm{det}(W^TY)\neq0\}.\]</p><p>We can find a canonical bijective mapping from the set <span>$\mathcal{U}_W$</span> to the set <span>$\mathcal{S}_W := \{Y\in\mathbb{R}^{N\times{}n}:W^TY=\mathbb{I}_n\}$</span>:</p><p class="math-container">\[\sigma_W: \mathcal{U}_W \to \mathcal{S}_W,\, \mathcal{Y}=\mathrm{span}(Y)\mapsto{}Y(W^TY)^{-1} =: \hat{Y}.\]</p><p>That <span>$\sigma_W$</span> is well-defined is easy to see: Consider <span>$YC$</span> with <span>$C\in\mathbb{R}^{n\times{}n}$</span> non-singular. Then <span>$YC(W^TYC)^{-1}=Y(W^TY)^{-1} = \hat{Y}$</span>. With this isomorphism we can also find a representation of elements of the tangent space:</p><p class="math-container">\[T_\mathcal{Y}\sigma_W: T_\mathcal{Y}Gr(n,N)\to{}T_{\hat{Y}}\mathcal{S}_W,\, \xi \mapsto (\xi_{\diamond{}Y} -\hat{Y}(W^T\xi_{\diamond{}Y}))(W^TY)^{-1}.\]</p><p><span>$\xi_{\diamond{}Y}$</span> is the representation of <span>$\xi\in{}T_\mathcal{Y}Gr(n,N)$</span> for the point <span>$Y\in{}St(n,N)$</span>, i.e. <span>$T_Y\pi(\xi_{\diamond{}Y}) = \xi$</span>; because the map <span>$\sigma_W$</span> does not care about the representation of <span>$\mathrm{span}(Y)$</span> we can perform the variations in <span>$St(n,N)$</span><sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>:</p><p class="math-container">\[\frac{d}{dt}Y(t)(W^TY(t))^{-1} = (\dot{Y}(0) - Y(W^TY)^{-1}W^T\dot{Y}(0))(W^TY)^{-1},\]</p><p>where <span>$\dot{Y}(0)\in{}T_YSt(n,N)$</span>. Also note that the representation of <span>$\xi$</span> in <span>$T_YSt(n,N)$</span> is not unique in general, but <span>$T_\mathcal{Y}\sigma_W$</span> is still well-defined. To see this consider two curves <span>$Y(t)$</span> and <span>$\bar{Y}(t)$</span> for which we have <span>$Y(0) = \bar{Y}(0) = Y$</span> and further <span>$T\pi(\dot{Y}(0)) = T\pi(\dot{bar{Y}}(0))$</span>. This is equivalent to being able to find a <span>$C(\cdot):(-\varepsilon,\varepsilon)\to{}O(n)$</span> for which <span>$C(0)=\mathbb{I}(0)$</span> s.t. <span>$\bar{Y}(t) = Y(t)C(t)$</span>. We thus have <span>$\dot{\bar{Y}}(0) = \dot{Y}(0) + Y\dot{C}(0)$</span> and if we replace <span>$\xi_{\diamond{}Y}$</span> above with the second term in the expression we get: <span>$Y\dot{C}(0) - \hat{Y}W^T(Y\dot{C}(0)) = 0$</span>. The parametrization of <span>$T_\mathcal{Y}Gr(n,N)$</span> with <span>$T_\mathcal{Y}\sigma_W$</span> is thus independent of the choice of <span>$\dot{C}(0)$</span> and hence of <span>$\xi_{\diamond{}Y}$</span> and is therefore well-defined.</p><p>Further note that we have <span>$T_\mathcal{Y}\mathcal{U}_W = T_\mathcal{Y}Gr(n,N)$</span> because <span>$\mathcal{U}_W$</span> is an open subset of <span>$Gr(n,N)$</span>. We thus can identify the tangent space <span>$T_\mathcal{Y}Gr(n,N)$</span> with the following set (where we again have <span>$\hat{Y}=Y(W^TY)^{-1}$</span>):</p><p class="math-container">\[T_{\hat{Y}}\mathcal{S}_W = \{(\Delta - Y(W^TY)^{-1}W^T\Delta)(W^T\Delta)^{-1}: Y\in{}St(n,N)\text{ s.t. }\mathrm{span}(Y)=\mathcal{Y}\text{ and }\Delta\in{}T_YSt(n,N)\}.\]</p><p>If we now further take <span>$W=Y$</span><sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> then we get the identification: </p><p class="math-container">\[T_\mathcal{Y}Gr(n,N) \equiv \{\Delta - YY^T\Delta: Y\in{}St(n,N)\text{ s.t. }\mathrm{span}(Y)=\mathcal{Y}\text{ and }\Delta\in{}T_YSt(n,N)\},\]</p><p>which is very easy to handle computationally (we simply store and change the matrix <span>$Y$</span> that represents an element of the Grassmann manifold). The Riemannian gradient is then </p><p class="math-container">\[\mathrm{grad}_\mathcal{Y}^{Gr}L = \mathrm{grad}_Y^{St}L - YY^T\mathrm{grad}_Y^{St}L = \nabla_Y{}L - YY^T\nabla_YL,\]</p><p>where <span>$\nabla_Y{}L$</span> again is the Euclidean gradient as in the <a href="../stiefel_manifold/">Stiefel manifold</a> case.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>I.e. <span>$Y(t)\in{}St(n,N)$</span> for <span>$t\in(-\varepsilon,\varepsilon)$</span>. We also set <span>$Y(0) = Y$</span>.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>We can pick any element <span>$W$</span> to construct the charts for a neighborhood around the point <span>$\mathcal{Y}\in{}Gr(n,N)$</span> as long as we have <span>$\mathrm{det}(W^TY)\neq0$</span> for <span>$\mathrm{span}(Y)=\mathcal{Y}$</span>. </li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../stiefel_manifold/">« Stiefel</a><a class="docs-footer-nextpage" href="../existence_and_uniqueness_theorem/">Differential Equations and the EAU theorem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Tuesday 23 January 2024 17:45">Tuesday 23 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
