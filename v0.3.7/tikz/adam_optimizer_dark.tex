\documentclass[crop, tikz]{standalone}

\usepackage{tikz}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[mode=buildnew]{standalone}

\usepackage{xcolor}


\usetikzlibrary{fit}

\definecolor{mred}{RGB}{214,39,40}
\definecolor{mgreen}{RGB}{44,160,44}


\begin{document}
\begin{tikzpicture}
    \node[rectangle, draw, white] (R1)    at (.3,0) {\color{white}$\mathbb{R}^N$};
    \node[rectangle, draw, white] (R2)  at (2, 2)   {\color{white}$\mathbb{R}^N$};
    \node[rectangle, draw, white] (cache) at (2, 0) {\color{white}$\mathtt{cache}$};
    \node[rectangle, draw, white] (R3) at (4, 1)    {\color{white}$\mathbb{R}^N$};
    \node[rectangle, draw, white] (R4)	at (4, 0)   {\color{white}$\mathbb{R}^N$};
    \coordinate[right of=R3, xshift=.5cm] (addition);
    \node[fit=(R2)(cache)(R3)(R4)(addition),draw, ultra thick, rounded corners, white, label=below:\color{white}$\mathtt{optimization\_step(o, ::}\mathbb{R}^N\mathtt{,::}\mathbb{R}^N\mathtt{)}$] (optimization_step) {};

    \draw[->, white] (R2) -- (cache) node[pos=.5, sloped, below] {\color{white}Adam};
    \draw[->, white] (cache) -- (R3) node[pos=.5, sloped, above] {\color{white}Adam};
    \draw[->, white] (R3) -- (R4) node[pos=.5, right]            {\color{white}Addition};
    \draw[->, mgreen] (R1) -- (R2) node[pos=.5, left] {\color{mgreen}AD};
\end{tikzpicture}
\end{document}