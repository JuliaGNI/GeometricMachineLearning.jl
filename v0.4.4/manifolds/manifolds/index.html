<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>General Theory on Manifolds · GeometricMachineLearning.jl</title><meta name="title" content="General Theory on Manifolds · GeometricMachineLearning.jl"/><meta property="og:title" content="General Theory on Manifolds · GeometricMachineLearning.jl"/><meta property="twitter:title" content="General Theory on Manifolds · GeometricMachineLearning.jl"/><meta name="description" content="Documentation for GeometricMachineLearning.jl."/><meta property="og:description" content="Documentation for GeometricMachineLearning.jl."/><meta property="twitter:description" content="Documentation for GeometricMachineLearning.jl."/><meta property="og:url" content="https://juliagni.github.io/GeometricMachineLearning.jl/manifolds/manifolds/"/><meta property="twitter:url" content="https://juliagni.github.io/GeometricMachineLearning.jl/manifolds/manifolds/"/><link rel="canonical" href="https://juliagni.github.io/GeometricMachineLearning.jl/manifolds/manifolds/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/extra_styles.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="GeometricMachineLearning.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="GeometricMachineLearning.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">HOME</a></li><li><span class="tocitem">Manifolds</span><ul><li><a class="tocitem" href="../basic_topology/">Concepts from General Topology</a></li><li><a class="tocitem" href="../metric_and_vector_spaces/">Metric and Vector Spaces</a></li><li><a class="tocitem" href="../inverse_function_theorem/">Foundations of Differential Manifolds</a></li><li class="is-active"><a class="tocitem" href>General Theory on Manifolds</a><ul class="internal"><li><a class="tocitem" href="#The-Preimage-Theorem"><span>The Preimage Theorem</span></a></li><li><a class="tocitem" href="#The-Immersion-Theorem"><span>The Immersion Theorem</span></a></li><li><a class="tocitem" href="#Tangent-Spaces"><span>Tangent Spaces</span></a></li><li><a class="tocitem" href="#Vector-Fields"><span>Vector Fields</span></a></li><li><a class="tocitem" href="#The-Tangent-Bundle"><span>The Tangent Bundle</span></a></li><li><a class="tocitem" href="#Library-Functions"><span>Library Functions</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../existence_and_uniqueness_theorem/">Differential Equations and the EAU theorem</a></li><li><a class="tocitem" href="../riemannian_manifolds/">Riemannian Manifolds</a></li><li><a class="tocitem" href="../homogeneous_spaces/">Homogeneous Spaces</a></li></ul></li><li><span class="tocitem">Special Arrays and AD</span><ul><li><a class="tocitem" href="../../arrays/skew_symmetric_matrix/">Symmetric and Skew-Symmetric Matrices</a></li><li><a class="tocitem" href="../../arrays/global_tangent_spaces/">Global Tangent Spaces</a></li><li><a class="tocitem" href="../../arrays/tensors/">Tensors</a></li><li><a class="tocitem" href="../../pullbacks/computation_of_pullbacks/">Pullbacks</a></li></ul></li><li><span class="tocitem">Structure-Preservation</span><ul><li><a class="tocitem" href="../../structure_preservation/symplecticity/">Symplecticity</a></li><li><a class="tocitem" href="../../structure_preservation/volume_preservation/">Volume-Preservation</a></li><li><a class="tocitem" href="../../structure_preservation/structure_preserving_neural_networks/">Structure-Preserving Neural Networks</a></li></ul></li><li><span class="tocitem">Optimizer</span><ul><li><a class="tocitem" href="../../optimizers/optimizer_framework/">Optimizers</a></li><li><a class="tocitem" href="../../optimizers/manifold_related/retractions/">Retractions</a></li><li><a class="tocitem" href="../../optimizers/manifold_related/parallel_transport/">Parallel Transport</a></li><li><a class="tocitem" href="../../optimizers/optimizer_methods/">Optimizer Methods</a></li><li><a class="tocitem" href="../../optimizers/bfgs_optimizer/">BFGS Optimizer</a></li></ul></li><li><span class="tocitem">Special Neural Network Layers</span><ul><li><a class="tocitem" href="../../layers/sympnet_gradient/">Sympnet Layers</a></li><li><a class="tocitem" href="../../layers/volume_preserving_feedforward/">Volume-Preserving Layers</a></li><li><a class="tocitem" href="../../layers/attention_layer/">(Volume-Preserving) Attention</a></li><li><a class="tocitem" href="../../layers/multihead_attention_layer/">Multihead Attention</a></li><li><a class="tocitem" href="../../layers/linear_symplectic_attention/">Linear Symplectic Attention</a></li></ul></li><li><span class="tocitem">Reduced Order Modeling</span><ul><li><a class="tocitem" href="../../reduced_order_modeling/reduced_order_modeling/">General Framework</a></li><li><a class="tocitem" href="../../reduced_order_modeling/pod_autoencoders/">POD and Autoencoders</a></li><li><a class="tocitem" href="../../reduced_order_modeling/losses/">Losses and Errors</a></li><li><a class="tocitem" href="../../reduced_order_modeling/symplectic_mor/">Symplectic Model Order Reduction</a></li></ul></li><li><a class="tocitem" href="../../port_hamiltonian_systems/">port-Hamiltonian Systems</a></li><li><span class="tocitem">Architectures</span><ul><li><a class="tocitem" href="../../architectures/abstract_neural_networks/">Using Architectures with <code>NeuralNetwork</code></a></li><li><a class="tocitem" href="../../architectures/symplectic_autoencoder/">Symplectic Autoencoders</a></li><li><a class="tocitem" href="../../architectures/neural_network_integrators/">Neural Network Integrators</a></li><li><a class="tocitem" href="../../architectures/hamiltonian_neural_network/">Hamiltonian Neural Network</a></li><li><a class="tocitem" href="../../architectures/sympnet/">SympNet</a></li><li><a class="tocitem" href="../../architectures/volume_preserving_feedforward/">Volume-Preserving FeedForward</a></li><li><a class="tocitem" href="../../architectures/transformer/">Standard Transformer</a></li><li><a class="tocitem" href="../../architectures/volume_preserving_transformer/">Volume-Preserving Transformer</a></li><li><a class="tocitem" href="../../architectures/linear_symplectic_transformer/">Linear Symplectic Transformer</a></li><li><a class="tocitem" href="../../architectures/symplectic_transformer/">Symplectic Transformer</a></li></ul></li><li><span class="tocitem">Data Loader</span><ul><li><a class="tocitem" href="../../data_loader/snapshot_matrix/">Snapshot matrix &amp; tensor</a></li><li><a class="tocitem" href="../../data_loader/data_loader/">Routines</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/sympnet_tutorial/">SympNets</a></li><li><a class="tocitem" href="../../tutorials/hamiltonian_neural_network/">Hamiltonian Neural Network</a></li><li><a class="tocitem" href="../../tutorials/symplectic_autoencoder/">Symplectic Autoencoders</a></li><li><a class="tocitem" href="../../tutorials/mnist/mnist_tutorial/">MNIST</a></li><li><a class="tocitem" href="../../tutorials/grassmann_layer/">Grassmann Manifold</a></li><li><a class="tocitem" href="../../tutorials/volume_preserving_attention/">Volume-Preserving Attention</a></li><li><a class="tocitem" href="../../tutorials/matrix_softmax/">Matrix Attention</a></li><li><a class="tocitem" href="../../tutorials/volume_preserving_transformer_rigid_body/">Volume-Preserving Transformer for the Rigid Body</a></li><li><a class="tocitem" href="../../tutorials/linear_symplectic_transformer/">Linear Symplectic Transformer</a></li><li><a class="tocitem" href="../../tutorials/symplectic_transformer/">Symplectic Transformer</a></li><li><a class="tocitem" href="../../tutorials/adjusting_the_loss_function/">Adjusting the Loss Function</a></li><li><a class="tocitem" href="../../tutorials/optimizer_comparison/">Comparing Optimizers</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li><li><a class="tocitem" href="../../docstring_index/">Index of Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manifolds</a></li><li class="is-active"><a href>General Theory on Manifolds</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>General Theory on Manifolds</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGNI/GeometricMachineLearning.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGNI/GeometricMachineLearning.jl/blob/main/docs/src/manifolds/manifolds.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="(Matrix)-Manifolds"><a class="docs-heading-anchor" href="#(Matrix)-Manifolds">(Matrix) Manifolds</a><a id="(Matrix)-Manifolds-1"></a><a class="docs-heading-anchor-permalink" href="#(Matrix)-Manifolds" title="Permalink"></a></h1><p>Manifolds are topological spaces that locally look like vector spaces. In the following we restrict ourselves to finite-dimensional smooth<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> manifolds. In this section we routinely denote points on a manifold by lower case letters like <span>$x, y$</span> and <span>$z$</span> if we speak about general properties and by upper case letters like <span>$A$</span> and <span>$B$</span> if we talk about specific examples of matrix manifolds. All manifolds that can be used to build neural networks in <code>GeometricMachineLearning</code>, such as the <a href="../homogeneous_spaces/#The-Stiefel-Manifold">Stiefel manifold</a> and the <a href="../homogeneous_spaces/#The-Grassmann-Manifold">Grassmann manifold</a> are matrix manifolds.</p><div class="admonition is-info" id="Definition-1ad2b1434664fea9"><header class="admonition-header">Definition<a class="admonition-anchor" href="#Definition-1ad2b1434664fea9" title="Permalink"></a></header><div class="admonition-body"><p>A <strong>finite-dimensional smooth manifold</strong> of dimension <span>$n$</span> is a second-countable Hausdorff space <span>$\mathcal{M}$</span> for which <span>$\forall{}x\in\mathcal{M}$</span> we can find a neighborhood <span>$U$</span>, that contains <span>$x,$</span> and a corresponding homeomorphism <span>$\varphi_U:U\cong{}W\subset\mathbb{R}^n$</span> where <span>$W$</span> is an open subset. The homeomorphisms <span>$\varphi_U$</span> are referred to as <em>coordinate charts</em>. If two such coordinate charts overlap, i.e. if <span>$U_1\cap{}U_2\neq\{\}$</span>, then the map <span>$\varphi_{U_2}\circ\varphi_{U_1}^{-1}$</span> has to be <span>$C^\infty$</span> on <span>$varphi_{U_1}(U_1\cap{}U_2).$</span> We call the collection of coordinate charts <span>$\{\varphi_U\}_{U\subset\mathcal{M}}$</span> an <strong>atlas</strong> for <span>$\mathcal{M}.$</span></p></div></div><p>One example of a manifold that is also important for <code>GeometricMachineLearning</code> is the Lie group<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> of orthonormal matrices <span>$SO(N)$</span>. Before we can proof that <span>$SO(N)$</span> is a manifold we first need the <em>preimage theorem</em>.</p><h2 id="The-Preimage-Theorem"><a class="docs-heading-anchor" href="#The-Preimage-Theorem">The Preimage Theorem</a><a id="The-Preimage-Theorem-1"></a><a class="docs-heading-anchor-permalink" href="#The-Preimage-Theorem" title="Permalink"></a></h2><p>The preimage theorem is crucial for treating the specific manifolds that are part of <code>GeometricMachineLearning</code>; the preimage theorem gives spaces like the <a href="../homogeneous_spaces/#The-Stiefel-Manifold">Stiefel manifold</a> the structure of a manifold. Before we can state the preimage theorem we need another definition:</p><div class="admonition is-info" id="Definition-8d19474831b4d0ad"><header class="admonition-header">Definition<a class="admonition-anchor" href="#Definition-8d19474831b4d0ad" title="Permalink"></a></header><div class="admonition-body"><p>Consider a smooth mapping <span>$g: \mathcal{M}\to\mathcal{N}$</span> from one manifold to another. A point <span>$y\in\mathcal{N}$</span> is called <strong>regular point of <span>$g$</span></strong> if <span>$\forall{}x\in{}g^{-1}\{y\}$</span> the map <span>$T_xg:T_x\mathcal{M}\to{}T_{y}\mathcal{N}$</span> is surjective.</p></div></div><div class="admonition is-success" id="Remark-9e46d726a75fda3c"><header class="admonition-header">Remark<a class="admonition-anchor" href="#Remark-9e46d726a75fda3c" title="Permalink"></a></header><div class="admonition-body"><p>Here we already used the notation <span>$T_y\mathcal{N}$</span> to denote the <em>tangent space to <span>$\mathcal{N}$</span> at <span>$y$</span></em>. We will explain what we mean by this precisely below. For now we simply view <span>$T_y\mathcal{N}$</span> as <em>something that is homemorphic to <span>$\mathbb{R}^m$</span></em> and the <em>tangent map <span>$T_xg$</span></em> we will simply view as <span>$(\psi\circ{}g\circ{}\varphi^{-1})&#39;(varphi(x)),$</span> where <span>$\varphi$</span> is a coordinate chart as <span>$x$</span> and <span>$\psi$</span> is a coordinate chart at <span>$y.$</span> In the examples we give below <span>$\mathcal{M}$</span> and <span>$\mathcal{N}$</span> will simply be vector spaces, and <span>$g$</span> will be differential map between vector spaces whose derivative at <span>$x\in{}f^{-1}\{y\}$</span> (for a regular point <span>$y$</span>) is surjective. For a vector space <span>$\mathcal{V}$</span> we furthermore have <span>$T_x\mathcal{V} = \mathcal{V}.$</span></p></div></div><p>We now state the preimage theorem:</p><div class="admonition is-info" id="Theorem-(Preimage-Theorem)-51412d33a25eebcb"><header class="admonition-header">Theorem (Preimage Theorem)<a class="admonition-anchor" href="#Theorem-(Preimage-Theorem)-51412d33a25eebcb" title="Permalink"></a></header><div class="admonition-body"><p>Consider a smooth map <span>$g:\mathcal{M}\to\mathcal{N}$</span> from one manifold to another (we assume the dimensions of the two manifolds to be <span>$m+n$</span> and <span>$m$</span> respectively). Then the preimage of a regular point <span>$y$</span> of <span>$\mathcal{N}$</span> is a submanifold of <span>$\mathcal{M}$</span>. Furthermore the codimension of <span>$g^{-1}\{y\}$</span> is equal to the dimension of <span>$\mathcal{N}$</span> and the tangent space <span>$T_x(g^{-1}\{y\})$</span> is equal to the kernel of <span>$T_xg$</span>.</p></div></div><details class="admonition is-details" id="Proof-1b2d46bc73be7ea9"><summary class="admonition-header">Proof<a class="admonition-anchor" href="#Proof-1b2d46bc73be7ea9" title="Permalink"></a></summary><div class="admonition-body"><p>Because <span>$\mathcal{N}$</span> has manifold structure we can find a chart <span>$\psi_U:U\to\mathbb{R}^m$</span> for some neighborhood <span>$U$</span> that contains <span>$y$</span>. We further consider a point <span>$x\in{}g^{-1}\{y\}$</span> and a chart around it <span>$\varphi_V:V\to\mathbb{R}^{m+n}$</span>. By the implicit function theorem we can then find a mapping <span>$h$</span> that turns <span>$\psi_U\circ{}g\circ\varphi_V^{-1}$</span> into a projection <span>$(x_1, \ldots, x_{n+m}) \mapsto (x_{n+1}, \ldots, x_{n+m})$</span>. We now consider the neighborhood <span>$V_1\times\{0\} = \varphi(V \cup f^{-1}\{y\})$</span> for <span>$\varphi(V) = V_1\times{}V_2$</span> with the coordinate chart <span>$(x_1, \ldots, x_n) \mapsto \varphi(x_1, \ldots, x_n, 0, \ldots, 0).$</span> As this map is also smooth by the implicit function theorem this proofs our assertion.</p></div></details><p>We now give some examples of manifolds that can be constructed this way:</p><div class="admonition is-info" id="Example-8033e1b18ed36362"><header class="admonition-header">Example<a class="admonition-anchor" href="#Example-8033e1b18ed36362" title="Permalink"></a></header><div class="admonition-body"><p>The group <span>$SO(N)$</span> is a Lie group (i.e. has manifold structure). <span>$SO(N)$</span> has dimension <span>$N(N-1)/2.$</span></p></div></div><details class="admonition is-details" id="Proof-d584e8dfeadac93e"><summary class="admonition-header">Proof<a class="admonition-anchor" href="#Proof-d584e8dfeadac93e" title="Permalink"></a></summary><div class="admonition-body"><p>The vector space <span>$\mathbb{R}^{N\times{}N}$</span> clearly has manifold structure. The group <span>$SO(N)$</span> is equivalent to one of the level sets of the mapping: <span>$g:\mathbb{R}^{N\times{}N}\to\mathcal{S}(N), A\mapsto{}A^TA - \mathbb{I}$</span>, i.e. it is the component of <span>$f^{-1}\{\mathbb{I}\}$</span> that contains <span>$\mathbb{I}$</span>; the image of <span>$f$</span> is contained in <span>$\mathcal{S}(N),$</span> the symmetric matrices of size <span>$N\times{}N.$</span> We still need to proof that <span>$\mathbb{I}$</span> is a regular point of <span>$g$</span>, i.e. that for <span>$A\in{}SO(N)$</span> the mapping <span>$T_Ag$</span> is surjective. This means that <span>$\forall{}B\in\mathcal{S}(N)$</span> <span>$\exists{}C\in\mathbb{R}^{N\times{}N}$</span> s.t. <span>$C^TA + A^TC = B$</span>. The element <span>$C=\frac{1}{2}AB\in\mathcal{R}^{N\times{}N}$</span> satisfies this property. The dimension of <span>$SO(N)$</span> is <span>$N(N-1)/2$</span> as <span>$\mathrm{dim}(\mathcal{S}(N))=N(N+1)/2.$</span></p></div></details><p>Similarly we can also proof: </p><div class="admonition is-info" id="Example-fb2e82c1ac9a19f4"><header class="admonition-header">Example<a class="admonition-anchor" href="#Example-fb2e82c1ac9a19f4" title="Permalink"></a></header><div class="admonition-body"><p>The sphere <span>$S^n:=\{x\in\mathbb{R}^{n+1}: x^Tx = 1\}$</span> is a manifold of dimension <span>$n$</span>.</p></div></div><details class="admonition is-details" id="Proof-3e7ee099ff78be47"><summary class="admonition-header">Proof<a class="admonition-anchor" href="#Proof-3e7ee099ff78be47" title="Permalink"></a></summary><div class="admonition-body"><p>Take <span>$g(x) = x^Tx - 1$</span> and proceed as in the case of <span>$SO(N)$</span>.</p></div></details><p>Note that both these manifolds, <span>$SO(N)$</span> and <span>$S^n$</span> are matrix manifolds, i.e. an element of <span>$\mathcal{M}$</span> can be written as an element of <span>$\mathbb{R}^{N\times{}N}$</span> in the first case and <span>$\mathbb{R}^{(n+1)\times{}1}$</span> in the second case. The additional conditions we impose on these manifolds are <span>$A^TA = \mathbb{I}$</span> in the first case and <span>$x^Tx = 1$</span> in the second case. Both of these manifolds belong to the category of <a href="../homogeneous_spaces/#The-Stiefel-Manifold">Stiefel manifolds</a> and therefore also to the bigger category of matrix manifolds, i.e. every element of <span>$SO(N)$</span> and of <span>$S^n$</span> can be represented as a matrix on which further conditions are imposed (e.g orthogonality).</p><h2 id="The-Immersion-Theorem"><a class="docs-heading-anchor" href="#The-Immersion-Theorem">The Immersion Theorem</a><a id="The-Immersion-Theorem-1"></a><a class="docs-heading-anchor-permalink" href="#The-Immersion-Theorem" title="Permalink"></a></h2><p>The immersion theorem, similarly to the preimage theorem, gives another way of constructing a manifold based on a non-linear function. </p><div class="admonition is-info" id="Theorem-(Immersion-Theorem)-da31459550833df1"><header class="admonition-header">Theorem (Immersion Theorem)<a class="admonition-anchor" href="#Theorem-(Immersion-Theorem)-da31459550833df1" title="Permalink"></a></header><div class="admonition-body"><p>Consider a differentiable function <span>$\mathcal{R}:\mathcal{N}\to\mathcal{M}$</span> with <span>$\mathrm{dim}(\mathcal{M}) = N &gt; n = \mathrm{dim}(\mathcal{N})$</span> tangent mapping <span>$T_x\mathcal{R}$</span> has full rank at every point <span>$x\in\mathcal{N}$</span>. Then <span>$\mathcal{R}(\mathcal{N})$</span> is a manifold <em>immersed</em> in <span>$\mathcal{M}$</span>.</p></div></div><p>The proof is again based on the <a href="../inverse_function_theorem/#The-Inverse-Function-Theorem">inverse function theorem</a>.</p><details class="admonition is-details" id="Proof-ee2b13e8258f163b"><summary class="admonition-header">Proof<a class="admonition-anchor" href="#Proof-ee2b13e8258f163b" title="Permalink"></a></summary><div class="admonition-body"><p>Consider a point <span>$x\in\mathcal{N},$</span> a coordinate chart <span>$\varphi$</span> around <span>$x$</span> and a coordinate chart <span>$\psi$</span> around <span>$f(x).$</span> We now define the function</p><p class="math-container">\[    F:(x_1, \ldots, x_N) \mapsto (\psi\circ{}f\circ\varphi^{-1}(x_1, \ldots, x_n), x_{n+1}, \ldots, x_N).\]</p><p>By the inverse function theorem we can find an inverse of <span>$F$</span> for a neighborhood around the point <span>$(x_1, \ldots, x_n, 0, \ldots, 0)\in\mathbb{R}^N.$</span> We call this neighborhood <span>$V = V_1\times{}V_2$</span> and the inverse <span>$H.$</span> We now constrain <span>$V$</span> to the set <span>$V_1\times{}0$</span>, which is isomorphic to a neighborhood around <span>$x$</span> in <span>$\mathbb{R}^n$</span>. We then have in this neighborhood:</p><p class="math-container">\[    H(\psi\circ{}f\circ\varphi^{-1}(x_1, \ldots, x_n), 0, \ldots, 0) = (x_1, \ldots, x_n, 0, \ldots, 0), \]</p><p>And we can take </p><p class="math-container">\[    y \mapsto \pi\circ{}H(\psi(y), 0 \ldots, 0)\]</p><p>as our coordinate chart. <span>$\pi:\mathbb{R}^N\to\mathbb{R}^n$</span> is the projection onto the first <span>$n$</span> coordinates.</p></div></details><p>We will use the immersion theorem when discussing the <a href="../../reduced_order_modeling/symplectic_mor/#The-Symplectic-Solution-Manifold">symplectic solution manifold</a>.</p><h2 id="Tangent-Spaces"><a class="docs-heading-anchor" href="#Tangent-Spaces">Tangent Spaces</a><a id="Tangent-Spaces-1"></a><a class="docs-heading-anchor-permalink" href="#Tangent-Spaces" title="Permalink"></a></h2><p>We already alluded to tangent spaces when talking about the preimage and the immersion theorems. Here we will give a precise definition. A tangent space can be seen as the <em>collection of all possible velocities a curve can take at a point on a manifold</em>. For this consider a manifold <span>$\mathcal{M}$</span> and a point <span>$x$</span> on it and the collection of <span>$C^\infty$</span> curves through <span>$x$</span>: </p><div class="admonition is-info" id="Definition-de3f628d6ad0b051"><header class="admonition-header">Definition<a class="admonition-anchor" href="#Definition-de3f628d6ad0b051" title="Permalink"></a></header><div class="admonition-body"><p>A mapping <span>$\gamma:(-\epsilon, \epsilon)\to\mathcal{M}$</span> that is <span>$C^\infty$</span> and for which we have <span>$\gamma(0) = x$</span> is called a <strong><span>$C^\infty$</span> curve through <span>$x$</span></strong>.</p></div></div><p>The tangent space of <span>$\mathcal{M}$</span> at <span>$x$</span> is the collection of the first derivatives of all <span>$\gamma$</span>: </p><div class="admonition is-info" id="Definition-f7b4bdc948abb9f8"><header class="admonition-header">Definition<a class="admonition-anchor" href="#Definition-f7b4bdc948abb9f8" title="Permalink"></a></header><div class="admonition-body"><p>The <strong>tangent space</strong> of <span>$\mathcal{M}$</span> at <span>$x$</span> is the collection of all <span>$C^\infty$</span> curves at <span>$x$</span> modulo the equivalence class <span>$\gamma_1 \sim \gamma_2 \iff \gamma_1&#39;(0) = \gamma_2&#39;(0)$</span>. It is denoted by <span>$T_x\mathcal{M}$</span>.</p></div></div><p>As is customary we write <span>$[\gamma]$</span> for the equivalence class of <span>$\gamma$</span> and this is by definition equivalent to <span>$\gamma&#39;(0)$</span>. The tangent space <span>$T_x\mathcal{M}$</span> can be shown to be homeomorphic<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup> to <span>$\mathbb{R}^n$</span> where <span>$n$</span> is the dimension of the manifold <span>$\mathcal{M}$</span>. If the homeomorphism is constructed through the coordinate chart <span>$(\varphi, U)$</span> we call it <span>$\varphi&#39;(x)$</span> or simply<sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup> <span>$\varphi&#39;$</span>. If we are given a map <span>$g:\mathcal{M}\to\mathcal{N}$</span> we further define <span>$T_xg = (\varphi&#39;)^{-1}\circ(\varphi\circ{}g\circ\psi^{-1})&#39;\circ{}\psi&#39;$</span>, i.e. a smooth map between two manifolds <span>$\mathcal{M}$</span> and <span>$\mathcal{N}$</span> induces a smooth map between the tangent spaces <span>$T_x\mathcal{M}$</span> and <span>$T_{g(x)}\mathcal{N}$</span>.</p><p>We want to demonstrate this principle of constructing the tangent space from curves through the example of <span>$S^2$</span>. We consider the following curves: </p><ol><li><span>$\gamma_1(t) = \begin{pmatrix} 0 \\ \sin(t) \\ \cos(t) \end{pmatrix},$</span></li><li><span>$\gamma_2(t) = \begin{pmatrix} \sin(t) \\ 0 \\ \cos(t) \end{pmatrix},$</span></li><li><span>$\gamma_3(t) = \begin{pmatrix} \exp(-t ^ 2 / 2)  t \sin(t) \\  \exp(-t ^ 2 / 2) t \cos(t) \\  \sqrt{1 - (t ^ 2) \exp(-t^2)} \end{pmatrix}.$</span></li></ol><p>We now plot the manifold <span>$S^2$</span>, the three curves described above and the associated tangent vectors (visualized as arrows). Note that the tangent vectors induced by <span>$\gamma_1$</span> and <span>$\gamma_3$</span> are the same; for these curves we have <span>$\gamma_1 \sim \gamma_3$</span> and the tangent vectors of those two curves coincide: </p><p><img src="../tangent_space_light.png" alt="Visualization of how the tangent space is constructed."/> <img src="../tangent_space_dark.png" alt="Visualization of how the tangent space is constructed."/></p><p>The tangent space <span>$T_x\mathcal{M}$</span> for</p><p class="math-container">\[x = \begin{pmatrix}0 \\ 0 \\ 1 \end{pmatrix}\]</p><p>is also shown. </p><h2 id="Vector-Fields"><a class="docs-heading-anchor" href="#Vector-Fields">Vector Fields</a><a id="Vector-Fields-1"></a><a class="docs-heading-anchor-permalink" href="#Vector-Fields" title="Permalink"></a></h2><p>A time-independent vector field<sup class="footnote-reference"><a id="citeref-5" href="#footnote-5">[5]</a></sup> is an object that specifies a velocity for every point on a domain. We first give the definition of a vector field on the vector space <span>$\mathbb{R}^n$</span> and limit ourselves here to <span>$C^\infty$</span> vector fields:</p><div class="admonition is-info" id="Definition-94a0d00993acf7a5"><header class="admonition-header">Definition<a class="admonition-anchor" href="#Definition-94a0d00993acf7a5" title="Permalink"></a></header><div class="admonition-body"><p>A <strong>vector field</strong> on <span>$\mathbb{R}^n$</span> is a smooth map <span>$X:\mathbb{R}^n\to\mathbb{R}^n$</span>.</p></div></div><p>The definition of a vector field on a manifold is not much more complicated: </p><div class="admonition is-info" id="Definition-6f1237a93ad341df"><header class="admonition-header">Definition<a class="admonition-anchor" href="#Definition-6f1237a93ad341df" title="Permalink"></a></header><div class="admonition-body"><p>A <strong>vector field</strong> on <span>$\mathcal{M}$</span> is a map <span>$X$</span> defined on <span>$\mathcal{M}$</span> such that <span>$X(x)\in{}T_x\mathcal{M}$</span> and <span>$\varphi&#39;\circ{}X\circ(\varphi)^{-1}$</span> is smooth for any coordinate chart <span>$(\varphi, U)$</span> that contains <span>$x$</span>.</p></div></div><p>In the section on the <a href="../existence_and_uniqueness_theorem/#The-Existence-And-Uniqueness-Theorem">existence-and-uniqueness theorem</a> we show that every vector field has a unique solution given an initial condition; i.e. given a point <span>$x\in\mathcal{M}$</span> and a vector field <span>$X$</span> we can find a curve <span>$\gamma$</span> such that <span>$\gamma(0) = x$</span> and <span>$\gamma&#39;(t) = X(\gamma(t))$</span> for all <span>$t$</span> in some interval <span>$(-\epsilon, \epsilon)$</span>.</p><h2 id="The-Tangent-Bundle"><a class="docs-heading-anchor" href="#The-Tangent-Bundle">The Tangent Bundle</a><a id="The-Tangent-Bundle-1"></a><a class="docs-heading-anchor-permalink" href="#The-Tangent-Bundle" title="Permalink"></a></h2><p>To each manifold <span>$\mathcal{M}$</span> we can associate another manifold which we call the <em>tangent bundle</em> and denote by <span>$T\mathcal{M}$</span>. The points on this manifold are: </p><p class="math-container">\[T\mathcal{M} = \{ (x, v_x): x\in\mathcal{M},\, v_x\in{}T_x\mathcal{M} \}.\]</p><p>Coordinate charts on this manifold can be constructed in a straightforward manner; for every coordinate chart <span>$\varphi_U$</span> the map <span>$\varphi_U&#39;(x)$</span> gives a homeomorphism between <span>$T_x\mathcal{M}$</span> and <span>$\mathbb{R}^n$</span> for any <span>$x\in{}U$</span>. We can then find a neighborhood of any point <span>$(x, v_x)$</span> by taking <span>$\pi^{-1}(U) = \{(x, v_x): x\in{}U, v_x\in{}T_x\mathcal{M}\}$</span> and this neighborhood is isomorphic to <span>$\mathbb{R}^{2n}$</span> via <span>$(x, v_x) \mapsto (\varphi_U(x), \varphi&#39;(x)v_x)$</span>. The <a href="../riemannian_manifolds/#Geodesic-Sprays-and-the-Exponential-Map">geodesic spray</a> is an important vector field defined on <span>$T\mathcal{M}$</span>.</p><h2 id="Library-Functions"><a class="docs-heading-anchor" href="#Library-Functions">Library Functions</a><a id="Library-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Library-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeometricMachineLearning.Manifold" href="#GeometricMachineLearning.Manifold"><code>GeometricMachineLearning.Manifold</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Manifold &lt;: AbstractMatrix</code></pre><p>A manifold in <code>GeometricMachineLearning</code> is a sutype of <code>AbstractMatrix</code>. All manifolds are matrix manifolds and therefore stored as matrices. More details can be found in the docstrings for the <a href="../homogeneous_spaces/#GeometricMachineLearning.StiefelManifold"><code>StiefelManifold</code></a> and the <a href="../homogeneous_spaces/#GeometricMachineLearning.GrassmannManifold"><code>GrassmannManifold</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGNI/GeometricMachineLearning.jl/blob/c1f877aded567da7282df9cbfd737fd178d68fa6/src/manifolds/abstract_manifold.jl#LL1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.rand-Union{Tuple{MT}, Tuple{Type{MT}, Integer, Integer}} where MT&lt;:Manifold" href="#Base.rand-Union{Tuple{MT}, Tuple{Type{MT}, Integer, Integer}} where MT&lt;:Manifold"><code>Base.rand</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rand(manifold_type, N, n)</code></pre><p>Draw random elements from the Stiefel and the Grassmann manifold. </p><p>Because both of these manifolds are compact spaces we can sample them uniformly [<a href="../../references/#mezzadri2006generate">18</a>].</p><p><strong>Examples</strong></p><p>When we call ...</p><pre><code class="language-julia hljs">using GeometricMachineLearning
using GeometricMachineLearning: _round # hide
import Random
Random.seed!(123)

N, n = 5, 3
Y = rand(StiefelManifold{Float32}, N, n)
_round(Y; digits = 5) # hide

# output

5×3 StiefelManifold{Float32, Matrix{Float32}}:
 -0.27575   0.32991   0.77275
 -0.62485  -0.33224  -0.0686
 -0.69333   0.36724  -0.18988
 -0.09295  -0.73145   0.46064
  0.2102    0.33301   0.38717</code></pre><p>... the sampling is done by first allocating a random matrix of size <span>$N\times{}n$</span> via <code>Y = randn(Float32, N, n)</code>.</p><p>We then perform a QR decomposition <code>Q, R = qr(Y)</code> with the <code>qr</code> function from the <code>LinearAlgebra</code> package (this is using Householder reflections internally). </p><p>The final output are then the first <code>n</code> columns of the <code>Q</code> matrix. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGNI/GeometricMachineLearning.jl/blob/c1f877aded567da7282df9cbfd737fd178d68fa6/src/manifolds/abstract_manifold.jl#LL74-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.rand-Union{Tuple{MT}, Tuple{KernelAbstractions.Backend, Type{MT}, Integer, Integer}} where MT&lt;:Manifold" href="#Base.rand-Union{Tuple{MT}, Tuple{KernelAbstractions.Backend, Type{MT}, Integer, Integer}} where MT&lt;:Manifold"><code>Base.rand</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rand(backend, manifold_type, N, n)</code></pre><p>Draw random elements for a specific device.</p><p><strong>Examples</strong></p><p>Random elements of the manifold can be allocated on GPU.  Call ...</p><pre><code class="language-julia hljs">rand(CUDABackend(), StiefelManifold{Float32}, N, n)</code></pre><p>... for drawing elements on a <code>CUDA</code> device.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGNI/GeometricMachineLearning.jl/blob/c1f877aded567da7282df9cbfd737fd178d68fa6/src/manifolds/abstract_manifold.jl#LL55-L69">source</a></section></article><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><div class="citation noncanonical"><dl><dt>[22]</dt><dd><div>P.-A. Absil, R. Mahony and R. Sepulchre. <em>Optimization algorithms on matrix manifolds</em> (Princeton University Press, Princeton, New Jersey, 2008).</div></dd></dl></div><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><em>Smooth</em> here means <span>$C^\infty$</span>.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Lie groups are manifolds that also have a <em>group structure</em>, i.e. there is an operation <span>$\mathcal{M}\times\mathcal{M}\to\mathcal{M},(a,b)\mapsto{}ab$</span> s.t. <span>$(ab)c = a(bc)$</span> and  there exists a neutral element<span>$e\mathcal{M}$</span> s.t. <span>$ae$</span> = <span>$a$</span> <span>$\forall{}a\in\mathcal{M}$</span> as well as an (for every <span>$a$</span>) inverse element <span>$a^{-1}$</span> s.t. <span>$a(a^{-1}) = e$</span>. The neutral element <span>$e$</span> we refer to as <span>$\mathbb{I}$</span> when dealing with matrix manifolds.</li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>Note that we have not formally defined addition for <span>$T_x\mathcal{M}$</span>. This can be done through the definition <span>$[\gamma] + [\beta] = [\alpha]$</span> where <span>$\alpha$</span> is any <span>$C^\infty$</span> curve through <span>$x$</span> that satisfies <span>$\alpha&#39;(0) = \beta(0) + \gamma(0)$</span>. Note that we can always find such an <span>$\alpha$</span> by the <a href="../existence_and_uniqueness_theorem/#The-Existence-And-Uniqueness-Theorem">existence and uniqueness theorem</a>.</li><li class="footnote" id="footnote-4"><a class="tag is-link" href="#citeref-4">4</a>We will further discuss this when we introduce the <a href="#The-Tangent-Bundle">tangent bundle</a>.</li><li class="footnote" id="footnote-5"><a class="tag is-link" href="#citeref-5">5</a>Also called <em>ordinary differential equation</em> (ODE).</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../inverse_function_theorem/">« Foundations of Differential Manifolds</a><a class="docs-footer-nextpage" href="../existence_and_uniqueness_theorem/">Differential Equations and the EAU theorem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Thursday 5 June 2025 10:27">Thursday 5 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
