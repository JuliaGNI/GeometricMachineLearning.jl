using GeometricMachineLearning: split_and_flatten